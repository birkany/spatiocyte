#!@SHELL@


PACKAGE=@PACKAGE@
VERSION=@VERSION@

prefix=/home/shafi/test
exec_prefix=${prefix}
pythondir=@pythondir@

export LD_LIBRARY_PATH="${LD_LIBRARY_PATH}:${exec_prefix}/lib"
export PYTHONPATH="$pythondir:${PYTHONPATH}"

PYTHON=@PYTHON@
DEBUGGER=gdb

BASENAME=`basename $0`

ecell3_usage() 
{
cat << EOT_USAGE
$BASENAME ( Package: $PACKAGE, Version: $VERSION )

Invoke python interpreter ready to import E-CELL module.
('import ecs' to load the module.)

Usage:

    Basic Usage:

        $BASENAME [OPTIONS]     --> invoke the python interpreter
        $BASENAME -h            --> print this message

    Debugging:

        If environment variable ECELL_DEBUG is set,

        $BASENAME [PYTHONOPTIONS]

        invokes

        $DEBUGGER $PYTHON 

        PYTHONOPTIONS are passed to the program via debugger's 
        --command= option.


Configurations:

        PACKAGE         = $PACKAGE
        VERSION         = $VERSION
	PYTHON          = $PYTHON
	PYTHONPATH      = $PYTHONPATH
        DEBUGGER        = $DEBUGGER
	LD_LIBRARY_PATH = $LD_LIBRARY_PATH
	prefix          = $prefix
        pythondir       = $pythondir

EOT_USAGE
}

cleanup()
{
    echo 'interrupted... cleaning up...'
    if [ $TMPFILE ] ; then
	rm -f $TMPFILE
    fi
    exit 1
}

trap cleanup 2 9 15

if [ "$1" = '-h' ] ; then
    ecell3_usage
    exit 0
fi

if [ ! $ECELL_DEBUG ] ; then
    exec $PYTHON $*
else
    TMPFILE=`mktemp -q /tmp/$BASENAME.XXXXXX`
    if [ $? -ne 0 ]; then
	echo "$BASENAME: Can't create temp file, exiting..."
	exit 1
    fi
    echo "run $*" > $TMPFILE
    echo $DEBUGGER --command=$TMPFILE $PYTHON
    $DEBUGGER --command=$TMPFILE $PYTHON
    rm -f $TMPFILE
fi



